<!DOCTYPE html>
<html lang="zh-CN">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="设计模式 - C++" />
    <meta name="hexo-theme-A4" content="v1.8.9" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Fingsinz&#39;s space | 风信梓</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--注意：首页既不是post也不是page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--返回顶部css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--目录-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.1.1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>
    
    <style>
        :root {
            --waline-theme-color: #000000; 
            --waline-color: #000000; 
            --waline-border-color: #000000; 
            --waline-white: #000000; 
            --waline-bgcolor-light: white;  
        }
        body {
            color: #000000;
            background: #bed2bb;
        }
        .post-md code {
            background: #e7f7f3;
            color: #7f688d; 
        }
        .post-md pre, .post-md .highlight {
            background: #e7f7f3;
            color: #7f688d; 
        }
        pre .string, pre .value, pre .inheritance, pre .header, pre .ruby .symbol, pre .xml .cdata {
            color: #000000;
        }
        pre .number, pre .preprocessor, pre .built_in, pre .literal, pre .params, pre .constant {
            color: #000000;
        }
        .year-font-color {
            color: #000000 !important;
        }
        .wl-card span.wl-nick {
            color: #000000; 
        }
        .wl-card .wl-badge {
            border: 1px solid #000000;
            color: #000000; 
        }
        .wl-btn {
            border: 1px solid #000000; 
            color:  #000000;  
        }
        .wl-btn.primary {
            color: white; 
        }
        .wl-header label {
            color: #000000;
        }
        a {
            color: #6b798e;
        }

        .post-md a {
            color: #6b798e;
        }

        .nav li a {
            color: #6b798e;
        }

        .archive-main a:link {
            color: #6b798e;
        }
        .archive-main a:visited {
            color: #6b798e; 
        }

        .archive li span {
            color: #000000;
        }

        .post-main-title {
            color: #000000;
        }

        .post-md h1,
        .post-md h2,
        .post-md h3,
        .post-md h4,
        .post-md h5,
        .post-md h6 {
            color: #000000;
        }

        [data-waline] p {
            color: #000000;
        }
        [data-waline] a {
            color: #000000;
        } 
        .wl-sort li.active {
            color: #000000;
        }

        .wl-card .wl-meta>span {
            background: white;
        }

        .paper {
            background: #bed2bb;
        }

        .index-main {
            background: white;
        }

        .paper-main {
            background: white;
        }

        .wl-panel {
            background: white;
        }

        .archive li:nth-child(odd) {
            background: white;
            ;
        }

        .archive li:nth-child(even) {
            background: white;
        }

        .post-md table tr:nth-child(odd) td {
            background: white;
        }

        .post-md table tr:nth-child(even) td {
            background: white;
        }

    
        .progress-wrap::after {
            color: #000000; /* 箭头的颜色 */
        }
        .progress-wrap svg.progress-circle path {
	        stroke: #000000; /* 边框的颜色 */
        }
        .progress-wrap::before {
	        background-image: linear-gradient(298deg, #6b798e, #6b798e); /* 鼠标滑过的箭头颜色 */
         }

        .return-to-last-progress-wrap::after {
            color: #000000; /* 箭头的颜色 */
        }
        .return-to-last-progress-wrap svg.progress-circle path {
	        stroke: #000000; /* 边框的颜色 */
        }
        .return-to-last-progress-wrap::before {
	        background-image: linear-gradient(298deg, #6b798e, #6b798e); /* 鼠标滑过的箭头颜色 */
         }

         .left-toc-container::-webkit-scrollbar-thumb {
            background-color: #000000; /* 设置滚动条拖动块的颜色 */
        }

        .bs-docs-sidebar .nav>.active>a,
        .bs-docs-sidebar .nav>li>a:hover,
        .bs-docs-sidebar .nav>li>a:focus {
            color: #6b798e;
            border-left-color: #6b798e;
        }
        .bs-docs-sidebar .nav>li>a {
            color:  #000000;
        }
    </style>

    
    <body>
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Fingsinz&#39;s space</a> 
            <span class="description">我在想，时下你所需要的，应该是痛痛快快换个心情，干干脆脆享受人生。</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">首页🏚️</a></li>
            
        
            
                <li><a href="/list/">文章📄</a></li>
            
        
            
                <li><a href="/notes/">笔记📔</a></li>
            
        
            
                <li><a href="/funny/">趣事💡</a></li>
            
        
            
                <li><a href="/about/">关于🧑</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--说明是文章post页面-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            设计模式 - C++
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">单例模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">单例模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%82%B9"><span class="post-toc-text">单例模式的优点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"><span class="post-toc-text">单例模式的基本原则</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">单例模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">单例模式设计题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">工厂方法模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">工厂方法模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">工厂方法模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">工厂方法模式设计题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">抽象工厂模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">工厂方法模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="post-toc-text">简单工厂、工厂方法、抽象工厂的区别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">抽象工厂模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">抽象工厂模式设计题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">建造者模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">建造者模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BC%98%E7%82%B9%E5%92%8C%E7%BC%BA%E7%82%B9"><span class="post-toc-text">建造者模式的优点和缺点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">建造者模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">建造者模式设计题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">原型模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">原型模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">原型模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">原型模式设计题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">适配器模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">适配器模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">适配器模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">适配器模式设计题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">代理模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">代理模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">代理模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">代理模式的设计题</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F"><span class="post-toc-text">装饰模式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E6%83%85%E5%BD%A2"><span class="post-toc-text">装饰模式的使用情形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="post-toc-text">装饰模式的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%AE%BE%E8%AE%A1%E9%A2%98"><span class="post-toc-text">装饰模式的设计题</span></a></li></ol></li></ol>
            
        
        <div class=".article-gallery"><p>关键词：C++、设计模式</p>
<span id="more"></span>
<hr>
<blockquote>
<p>Reference：<a target="_blank" rel="noopener" href="https://kamacoder.com/designpattern.php">卡码网KamaCoder - 设计模式精讲 - https://kamacoder.com/designpattern.php</a></p>
</blockquote>
<h2 id="单例模式">单例模式</h2>
<p>单例模式是<strong>创建型设计模式</strong>，保证一个类只有一个实例，并提供全局访问方法实现这个实例。</p>
<h3 id="单例模式的使用情形">单例模式的使用情形</h3>
<ol>
<li>资源共享：多个模块共享某个资源的时候，比如需要一个全局的配置管理器来存储和管理配置信息、亦或是使用单例模式管理数据库连接池。</li>
<li>只有一个实例。</li>
<li>懒加载：对象创建本身就比较消耗资源，而且可能在整个程序中都不一定会使用。</li>
</ol>
<h3 id="单例模式的优点">单例模式的优点</h3>
<ol>
<li>全局控制：保证只有一个实例，这样就可以严格的控制怎样访问它以及何时访问它。</li>
<li>节省资源：避免多次创建了相同的对象，从⽽节省了系统资源，⽽且多个模块还可以通过单例实例共享数据。</li>
<li>懒加载：可以实现懒加载，需要时才实例化。</li>
</ol>
<h3 id="单例模式的基本原则">单例模式的基本原则</h3>
<ol>
<li>不允许外部代码创建实例。</li>
<li>唯一实例保存在私有静态变量中。</li>
<li>通过公有静态方法获取唯一实例。</li>
</ol>
<h3 id="单例模式的实现">单例模式的实现</h3>
<ol>
<li>饿汉式：类加载时就完成了实例创建。</li>
<li>懒汉式：需要使用实例时在创建。
<ul>
<li>多个线程同时获取实例时，并且在同一时刻检测到实例没有被创建，就可能会同时创建实例，从而导致多个实例被创建。这个时候需要使用同步机制。</li>
</ul>
</li>
</ol>
<p>单例模式参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Singleton.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Singleton.png" alt=""></a></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> {</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton *<span class="title">GetInstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="type">static</span> Singleton instance;</span><br><span class="line">        <span class="keyword">return</span> &amp;instance;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Singleton</span>(Singleton <span class="type">const</span> &amp;other) = <span class="keyword">delete</span>;</span><br><span class="line">    <span class="built_in">Singleton</span>(Singleton <span class="type">const</span> &amp;&amp;other) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton &amp;<span class="keyword">operator</span>=(Singleton <span class="type">const</span> &amp;other) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton &amp;<span class="keyword">operator</span>=(Singleton <span class="type">const</span> &amp;&amp;other) = <span class="keyword">delete</span>;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="单例模式设计题">单例模式设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1074">【设计模式专题之单例模式】1.小明的购物车 (kamacoder.com)</a>：</p>
<blockquote>
<p>小明去了一家大型商场，拿到了一个购物车，并开始购物。请你设计一个购物车管理器，记录商品添加到购物车的信息（商品名称和购买数量），并在购买结束后打印出商品清单。（在整个购物过程中，小明只有一个购物车实例存在）。</p>
<p>输入包含若干行，每行包含两部分信息，分别是商品名称和购买数量。商品名称和购买数量之间用空格隔开。</p>
<p>输出包含小明购物车中的所有商品及其购买数量。每行输出一种商品的信息，格式为 “商品名称 购买数量”。</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/Singleton/main.cpp">Patterns/Singleton/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/Singleton/main.cpp">Singleton/main.cpp (gitee.com)</a></p>
<h2 id="工厂方法模式">工厂方法模式</h2>
<p>简单工厂模式：将产品的创建过程封装在一个工厂类中，把创建对象的流程集中在这个工厂类里面。</p>
<ul>
<li>三个主要角色，工厂类、抽象产品、具体产品。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_SimpleFactory.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_SimpleFactory.png" alt=""></a></p>
<p>工厂方法模式是<strong>创建型设计模式</strong>。</p>
<ul>
<li>简单工厂模式只有一个工厂类，负责创建所有产品，如果要添加新的产品，通常需要修改工厂类的代码。</li>
<li>工厂方法模式引⼊了抽象工厂和具体工厂的概念，每个具体工厂只负责创建一个具体产品，添加新的产品只需要添加新的工厂类而无需修改原来的代码。</li>
</ul>
<p>工厂方法模式的角色：</p>
<ul>
<li>抽象工厂：一个接口，包含一个抽象的工厂方法。</li>
<li>具体工厂：创建具体产品。</li>
<li>抽象产品：产品的接口。</li>
<li>具体产品：实现抽象产品接口，是工厂创建的对象。</li>
</ul>
<h3 id="工厂方法模式的使用情形">工厂方法模式的使用情形</h3>
<p>工厂方法模式使得每个工厂类的职责单一，每个工厂只负责创建一种产品。当创建对象涉及一系列复杂的初始化逻 辑，而这些逻辑在不同的子类中可能有所不同时，可以使用工厂方法模式将这些初始化逻辑封装在子类的工厂中。</p>
<h3 id="工厂方法模式的实现">工厂方法模式的实现</h3>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_FactoryMethod.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_FactoryMethod.png" alt=""></a></p>
<p>参考代码：</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Product</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Product</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Product</span>() {};</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">use</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteProductA</span> : <span class="keyword">public</span> Product {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ConcreteProductA</span>() {}</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">use</span><span class="params">()</span> </span>{</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"use ConcreteProductA\n"</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteProductB</span> : <span class="keyword">public</span> Product {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ConcreteProductB</span>() {};</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">use</span><span class="params">()</span> </span>{</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"use ConcreteProductB\n"</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Factory</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Factory</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Factory</span>() {};</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Product *<span class="title">createProduct</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFactoryA</span> : <span class="keyword">public</span> Factory {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ConcreteFactoryA</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ConcreteFactoryA</span>() {}</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Product *<span class="title">createProduct</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">ConcreteProductA</span>();</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFactoryB</span> : <span class="keyword">public</span> Factory {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ConcreteFactoryB</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ConcreteFactoryB</span>() {};</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Product *<span class="title">createProduct</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">ConcreteProductB</span>();</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="工厂方法模式设计题">工厂方法模式设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1076">【设计模式专题之工厂方法模式】2.积木工厂 (kamacoder.com)</a>：</p>
<blockquote>
<p>小明家有两个工厂，一个用于生产圆形积木，一个用于生产方形积木，请你帮他设计一个积木工厂系统，记录积木生产的信息。</p>
<p>输入的第一行是一个整数 N（1 ≤ N ≤ 100），表示生产的次数。</p>
<p>接下来的 N 行，每行输入一个字符串和一个整数，字符串表示积木的类型。积木类型分为 “Circle” 和 “Square” 两种。整数表示该积木生产的数量。</p>
<p>对于每个积木，输出一行字符串表示该积木的信息。</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/FactoryMethod/main.cpp">Patterns/FactoryMethod/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/FactoryMethod/main.cpp">FactoryMethod/main.cpp(gitee.com)</a></p>
<h2 id="抽象工厂模式">抽象工厂模式</h2>
<p>抽象工厂模式是<strong>创建型设计模式</strong>。抽象工厂模式可以确保一系列相关的产品被一起创建，这些产品能够相互配合使用。</p>
<p>在工厂方法模式中，每个具体工厂只负责创建单一的产品。但是如果有多类产品呢，比如说“手机”，一个品牌的手机有高端机、中低端机之分，这些具体的产品都需要建立一个单独的工厂类，但是它们都是相互关联的，都共同属于同一个品牌，这就可以使用到抽象工厂模式。</p>
<p>抽象工厂模式包括多个抽象产品、多个具体产品、一个抽象工厂和多个具体工厂，每个具体工厂负责创建一组相关产品。</p>
<h3 id="工厂方法模式的使用情形">工厂方法模式的使用情形</h3>
<p>抽象工厂模式能够保证一系列相关的产品一起使⽤，并且在不修改客户端代码的情况下，可以方便地替换整个产品系列。但是当需要增加新的产品类时，除了要增加新的具体产品类，还需要修改抽象工厂及其所有的具体工厂类，扩展性相对较差。</p>
<p>典型的应用场景是使用抽象工厂模式来创建与不同数据库的连接对象。</p>
<h3 id="简单工厂-工厂方法-抽象工厂的区别">简单工厂、工厂方法、抽象工厂的区别</h3>
<ul>
<li>
<p>简单工厂模式：一个工厂方法创建<strong>所有</strong>具体产品；</p>
</li>
<li>
<p>工厂方法模式：一个工厂方法创建<strong>一个</strong>具体产品；</p>
</li>
<li>
<p>抽象工厂模式：一个工厂方法可以创建<strong>一类</strong>具体产品。</p>
</li>
</ul>
<h3 id="抽象工厂模式的实现">抽象工厂模式的实现</h3>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_AbstractFactory.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_AbstractFactory.png" alt=""></a></p>
<p>遵循以下步骤：</p>
<ul>
<li>定义（一个或多个）抽象产品，声明产品的公共方法。</li>
<li>实现具体产品类。</li>
<li>定义抽象工厂，声明一组可用于创建产品的方法。</li>
<li>实现具体工厂。</li>
<li>客户端中使用抽象工厂和抽象产品。</li>
</ul>
<p>参考代码：</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AbstractProductA</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">AbstractProductA</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">AbstractProductA</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">use</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AbstractProductB</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">AbstractProductB</span>() = <span class="keyword">default</span>;</span><br><span class="line">    ~<span class="built_in">AbstractProductB</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">eat</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProductA1</span> : <span class="keyword">public</span> ::AbstractProductA {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ProductA1</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ProductA1</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">use</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"use ProductA1\n"</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProductA2</span> : <span class="keyword">public</span> AbstractProductA {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ProductA2</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ProductA2</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">use</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"use ProductA2\n"</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProductB1</span> : <span class="keyword">public</span> AbstractProductB {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ProductB1</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ProductB1</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">eat</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"eat ProductB1\n"</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProductB2</span> : <span class="keyword">public</span> AbstractProductB {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ProductB2</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ProductB2</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">eat</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"eat ProductB2\n"</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AbstractFactory</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">AbstractFactory</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">AbstractFactory</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> AbstractProductA *<span class="title">createProductA</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> AbstractProductB *<span class="title">createProductB</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFactory1</span> : <span class="keyword">public</span> AbstractFactory {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ConcreteFactory1</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ConcreteFactory1</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">AbstractProductA *<span class="title">createProductA</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">ProductA1</span>();</span><br><span class="line">    }</span><br><span class="line">    <span class="function">AbstractProductB *<span class="title">createProductB</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">ProductB1</span>();</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFactory2</span> : <span class="keyword">public</span> AbstractFactory {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ConcreteFactory2</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">ConcreteFactory2</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">AbstractProductA *<span class="title">createProductA</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">ProductA2</span>();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function">AbstractProductB *<span class="title">createProductB</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">ProductB2</span>();</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="抽象工厂模式设计题">抽象工厂模式设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1077">【设计模式专题之抽象工厂模式】3. 家具工厂 (kamacoder.com)</a>：</p>
<blockquote>
<p>小明家新开了两个工厂用来生产家具，一个生产现代风格的沙发和椅子，一个生产古典风格的沙发和椅子，现在工厂收到了一笔订单，请你帮他设计一个系统，描述订单需要生产家具的信息。</p>
<p>输入的第一行是一个整数 N（1 ≤ N ≤ 100），表示订单的数量。</p>
<p>接下来的 N 行，每行输入一个字符串，字符串表示家具的类型。家具类型分为 “modern” 和 “classical” 两种。</p>
<p>对于每笔订单，输出字符串表示该订单需要生产家具的信息。</p>
<p>modern订单会输出下面两行字符串</p>
<p>modern chair</p>
<p>modern sofa</p>
<p>classical订单会输出下面两行字符串</p>
<p>classical chair</p>
<p>classical soft</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/AbstractFactory/main.cpp">Patterns/AbstractFactory/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/AbstractFactory/main.cpp">AbstractFactory/main.cpp(gitee.com)</a></p>
<h2 id="建造者模式">建造者模式</h2>
<p>建造者（生成器）模式是<strong>创建型设计模式</strong>。主要思想是将对象的构建过程分为多个步骤，每个步骤定义一个抽象接口，具体构建过程有具体建造者类完成，同时有一个指导者类负责协调建造者的工作。</p>
<p>建造者模式有以下角色：</p>
<ul>
<li>产品：被构建的负责对象，包含多个组成部分。</li>
<li>抽象建造者：定义构建产品各部分的抽象类和一个返回复杂产品的方法。</li>
<li>具体建造者：实现抽象类的方法，构建产品各部分。</li>
<li>指导者：调用具体建造者的方法，按照一定顺序或逻辑构建。</li>
</ul>
<h3 id="建造者模式的使用情形">建造者模式的使用情形</h3>
<p>比如 Junit 中的测试构建器 TestBuilder，构建测试对象。</p>
<h3 id="建造者模式的优点和缺点">建造者模式的优点和缺点</h3>
<ul>
<li>将一个复杂对象的构建与其表示分离。</li>
<li>同样的构建过程可以创建不同的表示。</li>
<li>适用于复杂对象的创建。</li>
<li>当产品的构建过程发⽣变化时，可能需要同时修改指导类和建造者类，这就使得重构变得相对困难。</li>
</ul>
<h3 id="建造者模式的实现">建造者模式的实现</h3>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Builder.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Builder.png" alt=""></a></p>
<p>参考代码：</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Product</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setPart1</span><span class="params">(<span class="type">const</span> std::string&amp; part1)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>-&gt;part1 = part1;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setPart2</span><span class="params">(<span class="type">const</span> std::string&amp; part2)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>-&gt;part2 = part2;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function">std::string <span class="title">getProduct</span><span class="params">()</span> <span class="type">const</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> part1 + <span class="string">" "</span> + part2;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::string part1;</span><br><span class="line">    std::string part2;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Builder</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Builder</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">buildPart1</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">buildPart2</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> Product* <span class="title">getProduct</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteBuilder</span> : <span class="keyword">public</span> Builder {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ConcreteBuilder</span>() {</span><br><span class="line">        product = <span class="keyword">new</span> <span class="built_in">Product</span>();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">ConcreteBuilder</span>() {</span><br><span class="line">        <span class="keyword">delete</span> product;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">buildPart1</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        product-&gt;<span class="built_in">setPart1</span>(<span class="string">"Part1"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">buildPart2</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        product-&gt;<span class="built_in">setPart2</span>(<span class="string">"Part2"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function">Product* <span class="title">getProduct</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Product* product = <span class="literal">nullptr</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Director</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">construct</span><span class="params">(Builder* builder)</span> </span>{</span><br><span class="line">        builder-&gt;<span class="built_in">buildPart1</span>();</span><br><span class="line">        builder-&gt;<span class="built_in">buildPart2</span>();</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="建造者模式设计题">建造者模式设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1084">【设计模式专题之建造者模式】4. 自行车加工 (kamacoder.com)</a>：</p>
<blockquote>
<p>小明家新开了一家自行车工厂，用于使用自行车配件（车架 frame 和车轮 tires ）进行组装定制不同的自行车，包括山地车和公路车。</p>
<p>山地车使用的是Aluminum Frame（铝制车架）和 Knobby Tires（可抓地轮胎），公路车使用的是 Carbon Frame （碳车架）和 Slim Tries。</p>
<p>现在它收到了一笔订单，要求定制一批自行车，请你使用【建造者模式】告诉小明这笔订单需要使用那些自行车配置吧。</p>
<p>输入的第一行是一个整数 N（1 ≤ N ≤ 100），表示订单的数量。</p>
<p>接下来的 N 行，每行输入一个字符串，字符串表示客户的自行车需求。</p>
<p>字符串可以包含关键词 “mountain” 或 “road”，表示客户需要山地自行车或公路自行车。</p>
<p>对于每笔订单，输出该订单定制的自行车配置。</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/Builder/main.cpp">Patterns/Builder/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/Builder/main.cpp">Builder/main.cpp(gitee.com)</a></p>
<h2 id="原型模式">原型模式</h2>
<p>原型模式是<strong>创建型设计模式</strong>。核心思想是基于现有的对象创建新的对象。</p>
<p>原型模式包含两个重点模块：</p>
<ol>
<li>抽象原型类，且具有克隆自身的方法。</li>
<li>具体原型类，实现克隆方法，复制当前对象并返回一个新对象。</li>
</ol>
<h3 id="原型模式的使用情形">原型模式的使用情形</h3>
<p>通过原型模式复制对象可以减少资源消耗，提高性能，尤其在对象的创建过程复杂或对象的创建代价较大的情况下。</p>
<p>当需要频繁创建相似对象、并且可以通过克隆避免重复初始化工作的场景时可以考虑使用原型模式。</p>
<p>在克隆对象的时候还可以动态地添加或删除原型对象的属性，创造出相似但不完全相同的对象，提高了灵活性。</p>
<p>原型模式的例子：</p>
<ul>
<li>Java 提供了 Object 类的  <code>clone()</code> 方法，可以实现对象的浅拷贝。类需要实现 <code>Cloneable</code> 接口并重写 <code>clone()</code> 方法。</li>
<li>在 .NET 中，ICloneable 接口提供了 Cloneable 接口并重写 <code>Clone</code> 方法，可以用于实现对象的克隆。</li>
<li>Spring 框架中的 Bean 的作用域之一是原型作用域（Prototype Scope），在这个作用域下，Spring 框架会为每次请求创建⼀个新的 Bean 实例，类似于原型模式。</li>
</ul>
<h3 id="原型模式的实现">原型模式的实现</h3>
<p>参考代码：</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Prototype</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">Prototype</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> Prototype *<span class="title">clone</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcretePrototype</span> : <span class="keyword">public</span> Prototype {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">ConcretePrototype</span>(std::string <span class="type">const</span> &amp;data) : <span class="built_in">m_data</span>(data) {}</span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">ConcretePrototype</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">Prototype *<span class="title">clone</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">ConcretePrototype</span>(<span class="keyword">this</span>-&gt;m_data);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function">std::string <span class="title">getData</span><span class="params">()</span> <span class="type">const</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> m_data;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	std::string m_data;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="原型模式设计题">原型模式设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1083">【设计模式专题之原型模式】5. 矩形原型 (kamacoder.com)</a>：</p>
<blockquote>
<p>公司正在开发一个图形设计软件，其中有一个常用的图形元素是矩形。设计师在工作时可能需要频繁地创建相似的矩形，而这些矩形的基本属性是相同的（颜色、宽度、高度），为了提高设计师的工作效率，请你使用原型模式设计一个矩形对象的原型。使用该原型可以快速克隆生成新的矩形对象。</p>
<p>首先输入一个字符串，表示矩形的基本属性信息，包括颜色、长度和宽度，用空格分隔，例如 “Red 10 5”。</p>
<p>然后输入一个整数 N（1 ≤ N ≤ 100），表示使用原型创建的矩形数量。</p>
<p>对于每个矩形，输出一行字符串表示矩形的详细信息，如 “Color: Red, Width: 10,Height: 5”。</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/Prototype/main.cpp">Patterns/Prototype/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/Prototype/main.cpp">Prototype/main.cpp(gitee.com)</a></p>
<h2 id="适配器模式">适配器模式</h2>
<p>适配器模式是<strong>结构型设计模式</strong>。它将一个类的接口转换成客户希望的另一个接口，充当两个不同接口的桥梁，让不兼容的类一起工作。</p>
<p>适配器模式的基本角色有：</p>
<ul>
<li>目标接口：客户端希望使用的接口。</li>
<li>适配器类：实现客户端使用的接口，包含一个需要适配的类实例，起到转接扩展的作用。</li>
<li>被适配者：需要被适配的类。</li>
</ul>
<h3 id="适配器模式的使用情形">适配器模式的使用情形</h3>
<p>扮演着补救和扩展角色。</p>
<p>不同的项目和库可能使用不同的日志框架，不同的日志框架提供的 API 也不同，因此引⼊了适配器模式使得不同的 API 适配为统一接口。</p>
<p>Spring MVC 中，<code>HandlerAdapter</code> 接口就是适配器模式，将处理器适配到框架中，使得不同类型的处理器能够统一处理请求。</p>
<h3 id="适配器模式的实现">适配器模式的实现</h3>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Adapter.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Adapter.png" alt=""></a></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 目标接口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Target</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">request</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 被适配者</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Adaptee</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">specificRequest</span><span class="params">()</span> </span>{</span><br><span class="line">		std::cout &lt;&lt; <span class="string">"specificRequest"</span> &lt;&lt; std::endl;</span><br><span class="line">	}</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 适配器类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Adapter</span> : <span class="keyword">public</span> Target {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Adapter</span>(Adaptee *adaptee) {</span><br><span class="line">		m_adaptee = adaptee;</span><br><span class="line">	}</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">request</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">		m_adaptee-&gt;<span class="built_in">specificRequest</span>();</span><br><span class="line">	}</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	Adaptee *m_adaptee;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="适配器模式设计题">适配器模式设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1085">【设计模式专题之适配器模式】6. 扩展坞 (kamacoder.com)</a>：</p>
<blockquote>
<p>小明购买了一台新电脑，该电脑使用 TypeC 接口，为了确保新电脑可以使用现有的USB接口充电器和数据线，他购买了一个TypeC到USB的扩展坞。</p>
<p>请你使用适配器模式设计并实现这个扩展坞系统，确保小明的新电脑既可以通过扩展坞使用现有的USB接口充电线和数据线，也可以使用TypeC接口充电。</p>
<p>题目包含多行输入，第一行输入一个数字 N （1 &lt; N &lt;= 20)，表示后面有N组测试数据。</p>
<p>之后N行都是一个整数，1表示使用电脑本身的TypeC接口，2表示使用扩展坞的USB接口充电。</p>
<p>根据每行输入，输出相应的充电信息。</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/Adapter/main.cpp">Patterns/Adapter/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/Adapter/main.cpp">Adapter/main.cpp(gitee.com)</a></p>
<h2 id="代理模式">代理模式</h2>
<p>代理模式是<strong>结构型设计模式</strong>，用于控制对其他对象的访问。</p>
<p>代理模式允许一个对象（代理）充当另一个对象（真实对象）的接口，以控制对这个对象的访问。</p>
<ul>
<li>通常用于在访问某对象时引入间接层（中介作用），可以在访问对象时添加额外的控制逻辑，比如限制访问权限，延迟加载。</li>
</ul>
<p>比如进行文件加载，为了避免直接访问“文件"对象，可以新增一个代理对象，代理对象中有一个对“文件对象"的引用，在代理对象的 <code>1oad</code> 方法中，可以在访问真实的文件对象之前进行一些操作，比如权限检查，<br>
然后调用真实文件对象的 <code>1oad</code> 方法，最后在访问真实对象后进行其他操作，比如记录访问日志。</p>
<p>代理模式的角色有：</p>
<ul>
<li>抽象主题：抽象类，声明真实主题和代理对象实现的业务方法。</li>
<li>真实主题：定义了代理类所代表的真实对象。</li>
<li>代理类。</li>
</ul>
<h3 id="代理模式的使用情形">代理模式的使用情形</h3>
<p>代理模式可以在实际操作的前后添加一些额外的操作，但在多个对象交互之间可能会增加复杂性且降低性能。</p>
<p>代理模式在许多工具和库中也有应用：</p>
<ul>
<li>Spring 框架的 AOP 模块；</li>
<li>Java 提供动态代理机制；</li>
<li>Android 的 Glide 框架 使用代理模式实现图片的延迟加载。</li>
</ul>
<h3 id="代理模式的实现">代理模式的实现</h3>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Proxy.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Proxy.png" alt=""></a></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 抽象对象类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Subject</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">request</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体对象类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RealSubject</span> : <span class="keyword">public</span> Subject {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">request</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">		std::cout &lt;&lt; <span class="string">"RealSubject: Handling request.\n"</span>;</span><br><span class="line">	}</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// 代理类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Proxy</span> : <span class="keyword">public</span> Subject {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">request</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">		realSubject.<span class="built_in">request</span>();</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	RealSubject realSubject;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>代理模式目的是控制对对象的访问，同时还可以加入一些额外的逻辑；</p>
<p>适配器模式目的是使不兼容的对象能够协同工作，将一个类的接口转换成另一个类的接口。</p>
<h3 id="代理模式的设计题">代理模式的设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1088">【设计模式专题之代理模式】7-小明买房子 (kamacoder.com)</a>：</p>
<blockquote>
<p>小明想要购买一套房子，他决定寻求一家房屋中介来帮助他找到一个面积超过100平方米的房子，只有符合条件的房子才会被传递给小明查看。</p>
<p>第一行是一个整数 N（1 ≤ N ≤ 100），表示可供查看的房子的数量。</p>
<p>接下来的 N 行，每行包含一个整数，表示对应房子的房屋面积。</p>
<p>对于每个房子，输出一行，表示是否符合购房条件。如果房屋面积超过100平方米，输出 “YES”；否则输出 “NO”。</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/Proxy/main.cpp">Patterns/Proxy/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/Proxy/main.cpp">Proxy/main.cpp(gitee.com)</a></p>
<h2 id="装饰模式">装饰模式</h2>
<p>装饰模式是<strong>结构型设计模式</strong>。</p>
<ul>
<li>在不定义子类的情况下动态的给对象添加⼀些额外的功能。</li>
</ul>
<p>举个例子，假设有一个基础的图形类，想要为图形类添加颜色、边框、阴影等功能，如果每个功能都实现一个子类，就会导致产生大量的类。这时就可以考虑使用装饰模式来动态地添加，而不需要修改图形类本身的代码，这样可以使得代码更加灵活、更容易维护和扩展。</p>
<p>装饰模式包含四个角色：</p>
<ul>
<li>组件：抽象类，是具体组件和装饰者的父类，定义了具体组件需要实现的方法。</li>
<li>具体组件：实现组件的具体方法，是被装饰的对象。</li>
<li>装饰类：一个抽象类，给具体组件添加功能，但具体功能由具体装饰者完成，包含一个组件对象引用。</li>
<li>具体装饰类：扩展实现装饰类，负责向组件对象添加新的行为。</li>
</ul>
<h3 id="装饰模式的使用情形">装饰模式的使用情形</h3>
<ul>
<li>不希望使用继承生成子类，给现有的类添加附加功能时；</li>
<li>动态的添加和覆盖功能。</li>
</ul>
<p>Java 的 I/O 库 中，装饰模式用于增强 I/O 的功能。</p>
<h3 id="装饰模式的实现">装饰模式的实现</h3>
<p><a target="_blank" rel="noopener" href="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Decorator.png" class="gallery-item" style="box-shadow: none;"> <img src="https://fblog-1257020106.cos.ap-shanghai.myqcloud.com/imgs/designpattern_Decorator.png" alt=""></a></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Component</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">Component</span>() = <span class="keyword">default</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">operation</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteComponent</span> : <span class="keyword">public</span> Component {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operation</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">		std::cout &lt;&lt; <span class="string">"ConcreteComponent operation"</span> &lt;&lt; std::endl;</span><br><span class="line">	}</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Decorator</span> : <span class="keyword">public</span> Component {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Decorator</span>(Component *component) : <span class="built_in">m_component</span>(component) {}</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operation</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">		m_component-&gt;<span class="built_in">operation</span>();</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	Component *m_component;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteDecorator</span> : <span class="keyword">public</span> Decorator {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">ConcreteDecorator</span>(Component *component) : <span class="built_in">Decorator</span>(component) {}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operation</span><span class="params">()</span> <span class="keyword">override</span> </span>{</span><br><span class="line">		Decorator::<span class="built_in">operation</span>();</span><br><span class="line">		std::cout &lt;&lt; <span class="string">"ConcreteDecorator operation"</span> &lt;&lt; std::endl;</span><br><span class="line">	}</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="装饰模式的设计题">装饰模式的设计题</h3>
<p><a target="_blank" rel="noopener" href="https://kamacoder.com/problempage.php?pid=1086">【设计模式专题装饰模式】8-咖啡加糖 (kamacoder.com)</a>：</p>
<blockquote>
<p>小明喜欢品尝不同口味的咖啡，他发现每种咖啡都可以加入不同的调料，比如牛奶、糖和巧克力。他决定使用装饰者模式制作自己喜欢的咖啡。</p>
<p>请设计一个简单的咖啡制作系统，使用装饰者模式为咖啡添加不同的调料。系统支持两种咖啡类型：黑咖啡（Black Coffee）和拿铁（Latte）。</p>
<p>多行输入，每行包含两个数字。第一个数字表示咖啡的选择（1 表示黑咖啡，2 表示拿铁），第二个数字表示要添加的调料类型（1 表示牛奶，2 表示糖）。</p>
<p>根据每行输入，输出制作咖啡的过程，包括咖啡类型和添加的调料。</p>
</blockquote>
<p>参考代码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fingsinz/Patterns/blob/master/Decorator/main.cpp">Patterns/Decorator/main.cpp(github.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/fingsinz/design-patterns-in-cpp/blob/master/Decorator/main.cpp">Decorator/main.cpp(gitee.com)</a></p>
</div><script src="https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2024-03-24</span>
            
                <span>该篇文章被 Fingsinz</span>
            
            
                <span>打上标签:
                    
                    
                        <a href='/tags/C/'>
                            C++
                        </a>
                    
                        <a href='/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/'>
                            设计模式
                        </a>
                    
                </span>
             
             
                <span>归为分类:
                    
                    
                        <a href='/categories/%E7%AC%94%E8%AE%B0/'>
                            笔记
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>上一篇：<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">上一篇：<a href=""></a></span>
    </div> -->

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            ©2023-2024 

            
                

            
                
                    / <a href="/"> Fingsinz&#39;s Space </a>
                

            
                
                    / <a target="_blank" rel="noopener" href="https://www.zhihu.com/people/fingsinz"> 知乎 </a>
                

            
        </span>
    
</div>
<!--这是指一条线往下的内容-->
<div class="footer-last">
    
            <span>我在想，时下你所需要的，应该是痛痛快快换个心情，干干脆脆享受人生。</span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--目录-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--回到顶部按钮-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- 回到顶部的按钮-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- 返回的按钮-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>


</html>